setwd("C:/Downloads")
data=read.csv("C:/Downloads/diabetes.csv")
dim(data)
summary(data)
nrow(unique(data))
boxplot(data$Pregnancies)
boxplot(data$Age)
set.seed(234)
require(caret)
data_=createDataPartition(y=data$Outcome,p=0.7,list=FALSE)
data_train=data[data_,]
data_test=data[-data_,]
dim(data_train)
dim(data_test)
model_glm=glm(Outcome~.,data=data_train, family = "binomial")
summary(model_glm)
model_glm2=glm(Outcome~.-SkinThickness,data=data_train,family = "binomial")
summary(model_glm2)
model_glm3=glm(Outcome ~ Pregnancies+Glucose+BloodPressure+DiabetesPedigreeFunction,data = data_train,family = "binomial")
summary(model_glm3)
pred=predict(model_glm3,data_test,type = "response")
pred
data_test$Outcome
table(predicted=model_glm3$fitted.values>0.5,Actual=data_train$Outcome)
accuracy=(116+312)/(116+312+38+76)
presicion=(116)/(116+72)
  specificity=312/(312+38)
  sensitivity=116/(116+38)
  f1_score=2*0.5925926*0.4/(0.4+0.5925926)
  table(predicted=pred>0.5,Actual=data_test$Outcome)
accuracy=(32+128)/(32+128+22+48)
recall=32/(32+22)
precision=32/(32+48)
specificity=128/(128+22)
f1_score=2*0.6170213*0.7532468/(0.7532468+0.6170213)
f1require(ROCR)
dat=data[data_train,]
pred=predict(model_glm3,data_test,type = "response")
ROC_pred=prediction(pred,data_train$Outcome)
roc_perform=performance(ROC_pred,"tpr","fpr")
plot(roc_perform,colorize=T,print.cutoffs.at=seq(0.1,by=0.1))


table(predicted=pred>0.3,actual=data_test$Outcome)
accuracy=(64+102)/(102+17+47+64)
recall=(64)/(64+47)
precision=64/(64+17)
f1_score=2*0.7901235*0.5765766/(0.7901235+0.5765766)
